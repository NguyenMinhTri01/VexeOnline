(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59864252"],{"1d73":function(t,e,a){"use strict";var i=a("cbfe"),s=a.n(i);s.a},4074:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"loader"})},s=[],n={},l=n,r=(a("1d73"),a("2877")),o=Object(r["a"])(l,i,s,!1,null,null,null);e["a"]=o.exports},"9b49":function(t,e,a){},afa9:function(t,e,a){"use strict";var i=a("9b49"),s=a.n(i);s.a},cbfe:function(t,e,a){},f823:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container-fluid"},[a("h1",{staticClass:"h4 mb-2 text-gray-800"},[t._v("Sửa Xe")]),t.loading?a("Loader"):a("form",{attrs:{role:"form",method:"POST",enctype:"multipart/form-data"},on:{submit:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-8"},[a("div",{staticClass:"card shadow mb-4"},[a("div",{staticClass:"card-body"},[a("div",{staticClass:"form-group"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-8"},[a("label",{attrs:{for:"exampleInputEmail1"}},[t._v("Tên loại xe")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{type:"text",name:"name",autocomplete:"off"},domProps:{value:t.name},on:{blur:function(e){return t.$v.name.$touch()},input:function(e){e.target.composing||(t.name=e.target.value)}}}),t.$v.name.$dirty&&!t.$v.name.required?a("p",{staticClass:"alert-danger mt-2"},[t._v("Tên không được để trống !")]):t._e(),!t.$v.name.$dirty||t.$v.name.minLength&&t.$v.name.maxLength?t._e():a("p",{staticClass:"alert-danger mt-2"},[t._v("Độ dài tên phải từ 3 đến 255 ký tự !")])]),a("div",{staticClass:"col-sm-4"},[a("label",{attrs:{for:"exampleInputEmail1"}},[t._v("Số lượng chỗ ngồi")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.numberOfSeats,expression:"numberOfSeats"}],staticClass:"form-control",attrs:{type:"number",autocomplete:"off"},domProps:{value:t.numberOfSeats},on:{blur:function(e){return t.$v.numberOfSeats.$touch()},input:function(e){e.target.composing||(t.numberOfSeats=e.target.value)}}}),t.$v.numberOfSeats.$dirty&&!t.$v.numberOfSeats.required?a("p",{staticClass:"alert-danger mt-2"},[t._v("Số lượng chỗ ngồi không được để trống !")]):t._e(),t.$v.numberOfSeats.$dirty&&!t.$v.numberOfSeats.between?a("p",{staticClass:"alert-danger mt-2"},[t._v("Số lượng chỗ ngồi phải từ 4 đến 60 chỗ !")]):t._e()])])]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"exampleInputEmail1"}},[t._v("Các tiện ích trên xe (nếu có)")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.utilities,expression:"utilities"}],staticClass:"form-control",attrs:{name:"utilities",id:"",cols:"10",rows:"3"},domProps:{value:t.utilities},on:{blur:function(e){return t.$v.utilities.$touch()},input:function(e){e.target.composing||(t.utilities=e.target.value)}}}),!t.$v.utilities.$dirty||t.$v.utilities.minLength&&t.$v.utilities.maxLength?t._e():a("p",{staticClass:"alert-danger mt-2"},[t._v("Độ dài văn bản phải từ 3 đến 1000 ký tự !")])]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"exampleInput"}},[t._v("Album ảnh")]),0===t.vehicle.listImages.length?a("p",{staticClass:"alert-warning mt-2"},[t._v("Không ảnh nào để hiển thị")]):a("div",{staticClass:"row",staticStyle:{"margin-bottom":"30px"}},t._l(t.vehicle.listImages,(function(e){return a("div",{key:e._id,staticClass:"col-sm-4"},[a("div",{staticClass:"card-body border border-dark mb-3"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:"https://res.cloudinary.com/vexeonline/"+e.public_id,expression:"`https://res.cloudinary.com/vexeonline/${image.public_id}`"}],attrs:{alt:"image",width:"168",height:"100"}}),a("div",{staticClass:"text-center",staticStyle:{"margin-top":"10px"}},[a("span",{staticClass:"deleteImage",on:{click:function(a){return t.handleRemoveImage(e._id)}}},[a("i",{staticClass:"far fa-trash-alt",staticStyle:{"margin-right":"15px"}})]),a("a",{staticClass:"deleteImage",staticStyle:{color:"#858796"},attrs:{href:"https://res.cloudinary.com/vexeonline/"+e.public_id}},[a("i",{staticClass:"fas fa-eye"})])])])])})),0)]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"exampleInputEmail1"}},[t._v("Thêm ảnh mới vào Album")]),a("vue-dropzone",{ref:"myVueDropzone",attrs:{id:"dropzone",options:t.dropzoneOptions},on:{"vdropzone-removed-file":function(e){return t.removeFile(e)},"vdropzone-success":t.successUpload}})],1)])])]),a("div",{staticClass:"col-sm-4"},[a("div",{staticClass:"card shadow mb-4"},[a("div",{staticClass:"card-body"},[a("div",{staticClass:"text-center"},[t.urlImage?a("img",{staticClass:"image-preview ",attrs:{src:t.urlImage,alt:"avatar"}}):a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:"https://res.cloudinary.com/vexeonline/"+t.vehicle.avatar,expression:"`https://res.cloudinary.com/vexeonline/${vehicle.avatar}`"}],staticClass:"image-preview ",attrs:{alt:"avatar"}})]),a("div",{staticClass:"form-group mt-2"},[a("div",{staticClass:"custom-file"},[a("input",{staticClass:"custom-file-input",attrs:{type:"file",id:"customFile"},on:{change:t.previewFile}}),a("label",{staticClass:"custom-file-label",attrs:{for:"customFile"}},[t._v(t._s(t.fileName))]),t.errImage?a("p",{staticClass:"alert-danger mt-2"},[t._v(t._s(t.errImage))]):t._e()])])])])]),a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"card shadow mb-4"},[a("div",{staticClass:"card-footer text-center"},[a("router-link",{staticClass:"btn btn-sm btn-warning btn-icon-split",attrs:{to:"/admin/stations",type:"button"}},[a("span",{staticClass:"icon text-white-50"},[a("i",{staticClass:"fas fa-exclamation-triangle"})]),a("span",{staticClass:"text"},[t._v("Hủy Bỏ")])]),t._v(" "),a("button",{staticClass:"btn btn-sm btn-primary btn-icon-split",attrs:{type:"submit"}},[a("span",{staticClass:"icon text-white-50"},[t.loadingEdit?a("i",{staticClass:"fa fa-spinner fa-spin"}):a("i",{staticClass:"fa fa-save"})]),a("span",{staticClass:"text"},[t._v("Lưu")])])],1)])])])])],1)},s=[],n=(a("7db0"),a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("b5ae")),l=a("92c3"),r=a.n(l),o=a("4074"),c=(a("1e3f"),{name:"",components:{vueDropzone:r.a,Loader:o["a"]},data:function(){var t=this;return{fileName:"Chọn File Ảnh",name:"",numberOfSeats:"",utilities:"",urlImage:null,errImage:null,file:null,count:0,loadingEdit:!1,listImages:[],dropzoneOptions:{url:function(){var e=t.$store.state.auth.infoUser;return"http://localhost:5000/api/vehicles/upload-images/".concat(e._id)},thumbnailWidth:150,thumbnailHeight:150,maxFilesize:2,acceptedFiles:"image/*",headers:{Authorization:"authorizationHeader","Cache-Control":null,"X-Requested-With":null,token:this.$store.state.auth.token},dictDefaultMessage:"<i class='fa fa-cloud-upload'></i>Thêm Ảnh",maxFiles:6,paramName:"fileImage"}}},created:function(){this.$store.dispatch("fetchDetailVehicle",this.$route.params.id)},validations:{name:{required:n["required"],minLength:Object(n["minLength"])(3),maxLength:Object(n["maxLength"])(255)},numberOfSeats:{required:n["required"],between:Object(n["between"])(4,60)},utilities:{minLength:Object(n["minLength"])(3),maxLength:Object(n["maxLength"])(1e3)}},watch:{vehicle:function(t){t&&(this.name=t.name,this.numberOfSeats=t.numberOfSeats,this.utilities=t.utilities,1===this.count&&(this.loadingEdit=!1,this.listImages=[],this.$refs.myVueDropzone.removeAllFiles(),this.$toast.success("Cập nhật xe thành công",{position:"bottom-right"}),this.file=null,this.fileName="Chọn File Ảnh"))}},computed:{loading:function(){return this.$store.state.vehicle.loading},vehicle:function(){return this.$store.state.vehicle.vehicle},userInfo:function(){return this.$store.state.auth.infoUser}},methods:{handleSubmit:function(){if(this.$v.$anyError||this.errImage){if(!this.errImage&&this.file){var t=new FormData;t.append("avatar",this.file);var e={id:this.$route.params.id,fileAvatar:t};this.$store.dispatch("uploadAvatarVehicle",e),this.count=1,this.loadingEdit=!0}}else{var a={id:this.$route.params.id,name:this.name,numberOfSeats:this.numberOfSeats,utilities:this.utilities,listImages:this.listImages};if(this.count=1,this.loadingEdit=!0,this.file){var i=new FormData;i.append("avatar",this.file),this.$store.dispatch("putVehicle",{formData:a,fileAvatar:i})}else this.$store.dispatch("putVehicle",{formData:a,fileAvatar:null})}},previewFile:function(t){var e=["image/jpeg","image/png","image/gif"],a=t.target.files[0];e.find((function(t){return t===a.type}))?a.size>2097152?(this.errImage="kích thước file ảnh tối đa 2MB!",this.fileName="Chọn File Ảnh",this.urlImage=null):(this.file=a,this.fileName=a.name,this.errImage=null,this.urlImage=URL.createObjectURL(a)):(this.errImage="File ảnh không hợp lệ",this.fileName="Chọn File Ảnh",this.urlImage=null)},removeFile:function(){},successUpload:function(t,e){this.listImages.push(e.fileName)},handleRemoveImage:function(t){this.count=1,this.$store.dispatch("fetchDeleteImageOfVehicle",{id:this.vehicle._id,imageId:t})}}}),m=c,u=(a("afa9"),a("2877")),h=Object(u["a"])(m,i,s,!1,null,null,null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-59864252.5aa3adf4.js.map